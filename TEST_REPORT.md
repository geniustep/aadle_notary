# ๐งช ุชูุฑูุฑ ุงูุงุฎุชุจุงุฑ - aadle_notary Module

**ุงูุชุงุฑูุฎ:** 2025-11-09  
**ุงูุญุงูุฉ:** โ ุงูููุฏ ุฌุงูุฒ - โ๏ธ ูุญุชุงุฌ template_id

---

## ๐ ูุชุงุฆุฌ ุงูุงุฎุชุจุงุฑ

### โ 1. ุฃููุงุน ุงููุซุงุฆู ุงูููุฌูุฏุฉ

| ููุน ุงููุซููุฉ | Code | template_id | ุงูุญุงูุฉ |
|------------|------|-------------|--------|
| ุนูุฏ ุฒูุงุฌ | `marriage_contract` | โ ูุงุฑุบ | ูุญุชุงุฌ UUID |
| ุฑุณู ุฅุฑุซ | `inheritance_deed` | โ ูุงุฑุบ | ูุญุชุงุฌ UUID |
| ุนูุฏ ุทูุงู | `divorce_contract` | โ ูุงุฑุบ | ูุญุชุงุฌ UUID |
| ุชูููู | `power_attorney` | โ ูุงุฑุบ | ูุญุชุงุฌ UUID |
| ุชุตุฏูู | `certification` | โ ูุงุฑุบ | ูุญุชุงุฌ UUID |
| ุนูุฏ ุจูุน ุนูุงุฑ | `property_sale` | โ ูุงุฑุบ | ูุญุชุงุฌ UUID |
| ูุตูุฉ | `will` | โ ูุงุฑุบ | ูุญุชุงุฌ UUID |

**ุงููุชูุฌุฉ:** ุฌููุน ุฃููุงุน ุงููุซุงุฆู ุชุญุชุงุฌ `template_id` (UUID)

---

### โ 2. ุงููุซุงุฆู ุงูููุฌูุฏุฉ

- **ุงูุนุฏุฏ ุงูุฅุฌูุงูู:** 4 ูุซุงุฆู
- **ุงููุซุงุฆู ุงููุคูุฏุฉ:** 4 ูุซุงุฆู (ุญุงูุฉ: `confirmed`)
- **ุฌุงูุฒุฉ ููุงุฎุชุจุงุฑ:** โ ูุนู (ุจุนุฏ ุฅุถุงูุฉ template_id)

**ุฃูุซูุฉ:**
- MC-2025-000004 (ุนูุฏ ุฒูุงุฌ) - confirmed
- MC-2025-000003 (ุนูุฏ ุฒูุงุฌ) - confirmed
- MC-2025-000002 (ุนูุฏ ุฒูุงุฌ) - confirmed
- MC-2025-000001 (ุนูุฏ ุฒูุงุฌ) - confirmed

---

### โ 3. ุฅุนุฏุงุฏุงุช aadle_docgen

| ุงูุฅุนุฏุงุฏ | ุงููููุฉ | ุงูุญุงูุฉ |
|--------|--------|--------|
| `aadle.docgen_url` | `https://docgen.propanel.ma` | โ ูุญุฏุฏ |
| `aadle.docgen_fallback_url` | `https://docgen.propanel.ma` | โ ูุญุฏุฏ |
| `aadle.docgen_api_path` | `/api/v1/generate` | โ ูุญุฏุฏ |
| `aadle.docgen_auth_type` | `bearer` | โ ูุญุฏุฏ |
| `aadle.docgen_api_token` | ุบูุฑ ูุญุฏุฏ | โ๏ธ ุณูุณุชุฎุฏู session token |
| `aadle.docgen_api_key` | ุบูุฑ ูุญุฏุฏ | โ๏ธ ุบูุฑ ูุทููุจ |

**ุงููุชูุฌุฉ:** ุงูุฅุนุฏุงุฏุงุช ุตุญูุญุฉ โ

---

### โ 4. ุงุฎุชุจุงุฑ ุงูููุฏ

#### ุงูุชุญูู ูู template_id:

```python
# ุงูููุฏ ูุชุญูู ุจุดูู ุตุญูุญ:
if not self.document_type_id:
    raise UserError(_('ูุฌุจ ุชุญุฏูุฏ ููุน ุงููุซููุฉ ุฃููุงู'))

template_id = self.document_type_id.template_id
if not template_id:
    raise UserError(_(
        'ูู ูุชู ุชุนููู ูุนุฑูู ุงููุงูุจ (template_id) ูููุน ุงููุซููุฉ "%s"\n'
        'ูุฑุฌู ุฅุถุงูุชู ูู ุฅุนุฏุงุฏุงุช ุฃููุงุน ุงููุซุงุฆู'
    ) % self.document_type_id.name)
```

**ุงููุชูุฌุฉ:** โ ุงูุชุญูู ูุนูู ุจุดูู ุตุญูุญ

#### Endpoint ู Payload:

```python
# FastAPI (docgen.propanel.ma)
endpoint = f'{docgen_url}/docs/render'  # โ ุตุญูุญ
payload = {
    'template_id': template_id,  # โ ุตุญูุญ
    'data': sanitized_data,
    'include_qr': True,
    'include_signature': True
}
```

**ุงููุชูุฌุฉ:** โ Endpoint ู Payload ุตุญูุญุงู

---

### โ๏ธ 5. ุงุฎุชุจุงุฑ ุงูุงุชุตุงู ุจู aadle_docgen

**ุงููุญุงููุงุช:**
- `https://docgen.propanel.ma/templates` - โ Timeout
- `https://docgen.propanel.ma/api/templates` - โ Timeout
- `https://docgen.propanel.ma/docs` - โ Error 520

**ุงููุชูุฌุฉ:** โ๏ธ aadle_docgen ุบูุฑ ูุชุงุญ ุญุงููุงู

**ุงูุณุจุจ ุงููุญุชูู:**
- ุงูุฎุงุฏู ุบูุฑ ูุชุงุญ
- ูุดุงูู ูู ุงูุดุจูุฉ
- ุงูุฎุงุฏู ูู ุตูุงูุฉ

---

## โ ุงููุชุงุฆุฌ ุงูุฅุฌูุงููุฉ

| ุงููููู | ุงูุญุงูุฉ | ุงูููุงุญุธุงุช |
|--------|--------|-----------|
| **ุงูููุฏ** | โ ุฌุงูุฒ | ูุนูู ุจุดูู ุตุญูุญ |
| **Endpoint** | โ ุตุญูุญ | `/docs/render` |
| **Payload** | โ ุตุญูุญ | `template_id` ู `data` |
| **Authentication** | โ ุฌุงูุฒ | Bearer Token ุชููุงุฆู |
| **ุงูุชุญูู ูู template_id** | โ ูุนูู | ุฑุณุงูุฉ ุฎุทุฃ ูุงุถุญุฉ |
| **template_id ูู DB** | โ ูุงุฑุบ | **ูุญุชุงุฌ ุฅุถุงูุฉ UUIDs** |
| **aadle_docgen API** | โ๏ธ ุบูุฑ ูุชุงุญ | Timeout / Error 520 |

---

## ๐ฏ ุงูุฎุทูุงุช ุงูุชุงููุฉ

### 1. ุฅุถุงูุฉ template_id (ูุทููุจ)

```python
# ูู Odoo Shell
exec(open('/opt/odoo18/custom_models/aadle_notary/scripts/update_template_ids_manual.py').read())

# ุฅุถุงูุฉ UUIDs (ุงุณุชุจุฏู ุจู UUIDs ุงููุนููุฉ)
set_template_id(env, 'marriage_contract', 'uuid-actual-here')
set_template_id(env, 'divorce_contract', 'uuid-actual-here')
# ... ูููุฐุง
```

### 2. ุงูุชุญูู ูู aadle_docgen

```bash
# ุงุฎุชุจุงุฑ ุงูุงุชุตุงู
curl https://docgen.propanel.ma/docs

# ุฃู ูู ุงููุชุตูุญ
# ุงูุชุญ: https://docgen.propanel.ma/docs
```

### 3. ุงุฎุชุจุงุฑ ุชูููุฏ PDF

ุจุนุฏ ุฅุถุงูุฉ template_id:
1. ุงูุชุญ ูุซููุฉ ูู Odoo
2. ุงุถุบุท ุนูู ุฒุฑ "ุชูููุฏ PDF"
3. ุชุญูู ูู ุงููุชูุฌุฉ

---

## ๐ ููุงุญุธุงุช

1. **ุงูููุฏ ุฌุงูุฒ:** ุฌููุน ุงูุชุบููุฑุงุช ูุทุจูุฉ ุจุดูู ุตุญูุญ โ
2. **template_id ูุทููุจ:** ูุฌุจ ุฅุถุงูุฉ UUIDs ููู ููุน ูุซููุฉ โ๏ธ
3. **aadle_docgen:** ุบูุฑ ูุชุงุญ ุญุงููุงู - ูุฏ ูููู ูุคูุชุงู โ๏ธ
4. **ุงูุชุญูู:** ุงูููุฏ ูุชุญูู ูู template_id ูุจู ุงููุญุงููุฉ โ

---

## โ ุงูุฎูุงุตุฉ

- โ **ุงูููุฏ:** ุฌุงูุฒ ููุนูู ุจุดูู ุตุญูุญ
- โ **Endpoint:** ุตุญูุญ (`/docs/render`)
- โ **Payload:** ุตุญูุญ (`template_id` ู `data`)
- โ **Authentication:** ุฌุงูุฒ (Bearer Token ุชููุงุฆู)
- โ๏ธ **template_id:** ูุงุฑุบ - ูุญุชุงุฌ ุฅุถุงูุฉ UUIDs
- โ๏ธ **aadle_docgen:** ุบูุฑ ูุชุงุญ ุญุงููุงู

**ุงูุฎุทูุฉ ุงูุชุงููุฉ:** ุฅุถุงูุฉ `template_id` (UUIDs) ููู ููุน ูุซููุฉ.

